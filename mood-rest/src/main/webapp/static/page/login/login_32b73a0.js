define("page/login/login",["require","exports","module","components/app/app","components/app/api"],function(e){var a=e("components/app/app"),s=e("components/app/api");$().ready(function(){$("#doc-vld-msg").validate({rules:{username:{required:!0,minlength:2},password:{required:!0}},messages:{username:{required:"用户名不能为空哦",minlength:"用户名不能太短哦"},password:{required:"密码不能为空哦"}}})}),$(function(){$("#doc-vld-msg").validator({onValid:function(e){$(e.field).closest(".am-form-group").find(".am-alert").hide()},onInValid:function(e){var a=$(e.field),s=a.closest(".am-form-group"),o=s.find(".am-alert"),n=a.data("validationMessage")||this.getValidationMessage(e);o.length||(o=$('<div class="am-alert am-alert-danger"></div>').hide().appendTo(s)),o.html(n).show()}})}),$("#login").click(function(){if($("#doc-vld-msg").valid()){alert("恭喜你，验证通过了！"),$("#login").attr("disabled","true"),$("#login").val("登录中...");var e=s.login,o={username:$("#username").val(),password:$("#password").val(),grant_type:"password"},n=function(e){if($("#login").removeAttr("disabled"),$("#login").val("登录"),200==e.code)a.sets("user",e.data[0]),a.message("登录成功","success"),setTimeout(function(){history.back()},1300);else{if(20003!=e.code)return a.message(e.message,"error"),!1;a.message(e.message,"error")}};a.ajax(e,"post",o,n)}})});